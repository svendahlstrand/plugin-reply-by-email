{{ $email_address := $.Site.Params.reply_by_email_address }}
{{ $link_text := $.Site.Params.reply_by_email_link_text }}
{{ $subject := $.Site.Params.reply_by_email_subject_prefix }}
{{ $subject  = print $subject (or .Title ( .Permalink | safeURL )) }}

{{ if in $email_address "@" }}
	{{ if .Title }}
  		<a class="reply-by-email" href="mailto:{{ $email_address }}?subject={{ $subject | htmlUnescape | truncate 60 }}">{{ or $link_text "Reply by email" }}</a>
	{{ else }}
		  <a class="reply-by-email" href="mailto:{{ $email_address }}?subject={{ $subject }}">{{ or $link_text "Reply by email" }}</a>
	{{ end }}
{{ else }}
  <a class="reply-by-email" href="#">{{ or $link_text "Reply by email" }}</a>
  This blog's owner has not provided a valid email address yet.
{{ end }}
